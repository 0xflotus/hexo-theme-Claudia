<style>
    .post-hover:hover {
        box-shadow: inset 0 0 100px #000;
        transition: box-shadow .2s;
    }

    .post-hover:hover h3 {
        text-decoration: underline gray;
    }

    .primary-post-container{
        height: 377px;
        margin-bottom: 15px;
    }

    .primary-post-container .title {
        color: #fff;
    }

    .primary-post-container .sub-title {
        color: #fff;
    }
    .primary-post-container .date {
        color: #f1f1f1;
    }

    .post-content-text {
        color: #fff;
    }

    .primary-item-main,
    .primary-item-sub {
        background-color: #636363;
    }

    .primary-item-main {
        width: 100%;
        display: flex;
        align-items: center;
        background-size: cover;
    }

    .primary-item-main > div {
        height: 140px;
    }

    .primary-item-sub {
        display: flex;
        align-items: center;
        height: 48.6%;
        background-size: cover;
    }

    .primary-item-sub > div {
        height: 100px;
        display: flex;
        align-items: center;

        padding-left: 15px;
    }

    /*次要的 post 内容样式*/

    .sub-post-container {
        min-height: 240px;

        margin-bottom: 15px;
        padding: 15px 0;
        border-bottom: 1px solid #e1e1e1;
    }

    .sub-post-container .post-content {
        padding-left: 15px;
        padding-right: 15px;
    }

    .primary-post-container h3.title {

    }
</style>
<%
    function getPostCoverPhoto(post) {
        var content = post.content
        var regex = /<img src="\S+"/
        var result = regex.exec(content)

        // is post first img
        if (result) {
            return result[0].split('src="')[1].split('"')[0]
        }

        // is anisina font-matter
        if (post.header_img){
            return post.header_img
        }

        return ''
    }
%>
<div style="background: #f5f8f9;">
    <div id="main-container" class="container" style="padding-top: 20px;">
        <div class="is-flex main-content justify-center">
            <section class="column is-9" style="padding-right: 0;">
                <%- partial('_partial/primary_content', {posts: page.posts, getPostCoverPhoto: getPostCoverPhoto}) %>
                <% if (page.posts.length > 0){%>
                    <% page.posts.each (function (post, index) { %>
                    <% if ( index > 2 ){%>
                        <a class="post-hover" href="<%= config.root + post.path %>">
                            <div class="sub-post-container is-flex content-box clear-padding">
                                <% if (getPostCoverPhoto(post)){%>
                                    <div class="flex-1 post-avatar"
                                         style="margin: 0 12px;background-image: url('<%- getPostCoverPhoto(post) %>')" >
                                    </div>
                                <%}%>
                                <div class="flex-2 post-content is-flex align-center">
                                    <div class="content">
                                        <h3><%= post.title || 'Null' %></h3>
                                        <% if (post.subtitle){%>
                                            <p class="sub-title"><%- post.subtitle %></p>
                                        <%}%>
                                        <p>
                                            <% post.tags.forEach(function(tag){%>
                                                <span class="tag is-post-tag"><%- tag.name %></span>
                                            <%})%>
                                        </p>
                                        <p>
                                            <%- truncate(strip_html(post.content), {length: 180, omission: '..'}) %>
                                        </p>
                                        <p><%= post.date.format(config.date_format) %></p>
                                        <button class="button is-small">Read More</button>
                                    </div>
                                </div>
                            </div>
                        </a>
                    <%}%>
                <% })%>
                <%}%>
                <!--翻頁-->
                <nav class="pagination is-flex" style="justify-content: flex-end">
                    <% if (is_home()){%>
                        <% if (page.prev){%>
                            <a class="pagination-previous" href="<%- config.root %><%- page.prev_link %>">Previous</a>
                        <%}%>
                        <% if (page.next){ %>
                            <a class="pagination-next" href="<%- config.root %><%- page.next_link %>">Next page</a>
                        <%}%>
                    <%}%>
                </nav>
            </section>
            <% if(is_home()){ %>
                <%- partial('_partial/sidebar', null, {cache: !config.relative_link}) %>
            <%}%>
        </div>
    </div>
</div>
